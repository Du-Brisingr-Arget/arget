#!/bin/bash

mkdir -p ~/arget
cd ~/arget
touch all-package-names.argt

if [ $1 = '-i' ]; then
  echo $2 > tmp.argt
  for f in `cat tmp.argt`; do 
    pkgurl=https://aur.archlinux.org/$f.git
    mkdir ./arget-tmp
    cd arget-tmp
    git clone $pkgurl
    gitname=$( ls )
    cd $gitname
    makepkg -sirc --noconfirm
    cd ..
    cd ..
    rm -rf arget-tmp
  done 
  pkgbf=$( cat all-package-names.argt )
  pkgnw=$( cat tmp.argt )
  pkg="$pkgbf $pkgnw"
  echo $pkg > tmp.all-package-names.argt
  sort tmp.all-package-names.argt | uniq
  awk '!x[$0]++' tmp.all-package-names.argt > tmp.tmp.all-package-names.argt
  cat tmp.tmp.all-package-names.argt | tr "\n" " " > all-package-names.argt
  rm tmp.argt
  rm tmp.all-package-names.argt
  rm tmp.tmp.all-package-names.argt
fi
